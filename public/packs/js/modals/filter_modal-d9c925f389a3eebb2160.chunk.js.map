{"version":3,"sources":["webpack:///./app/javascript/mastodon/features/filters/added_to_filter.jsx","webpack:///./app/javascript/mastodon/features/filters/select_filter.jsx","webpack:///./app/javascript/mastodon/features/ui/components/filter_modal.jsx"],"names":["AddedToFilter","PureComponent","constructor","arguments","_defineProperty","onClose","this","props","render","filter","contextType","expiredMessage","get","Date","_jsxs","_Fragment","children","_jsx","className","FormattedMessage","id","defaultMessage","contextMismatchMessage","includes","toServerSideType","settings_link","href","values","title","Button","onClick","handleCloseClick","connect","mapStateToProps","state","_ref","filterId","getIn","messages","defineMessages","search","clear","SelectFilter","searchValue","warning","role","tabIndex","handleItemClick","onKeyDown","handleKeyDown","_ref2","target","setState","value","c","listNode","e","index","Array","from","childNodes","findIndex","node","currentTarget","element","key","click","firstChild","lastChild","shiftKey","focus","preventDefault","stopPropagation","getAttribute","onSelectFilter","onNewFilter","filters","fuzzysort","go","keys","limit","threshold","map","result","obj","renderCreateNew","name","handleNewFilterClick","Icon","icon","AddIcon","intl","isSearching","results","type","onChange","handleSearchChange","handleSearchKeyDown","placeholder","formatMessage","autoFocus","disabled","handleClear","deleteIcon","loupeIcon","ref","setListRef","renderItem","_filter$get","keyword","join","injectIntl","close","FilterModal","ImmutablePureComponent","step","isSubmitting","isSubmitted","handleSelectFilter","dispatch","statusId","fetchStatus","createFilterStatus","filter_id","status_id","handleSuccess","handleFail","createFilter","context","action","handleNewFilterSuccess","componentDidMount","fetchFilters","stepComponent","handleNewFilter","IconButton","iconComponent","CloseIcon","size","PropTypes","string","isRequired","func","object"],"mappings":"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","file":"js/modals/filter_modal-d9c925f389a3eebb2160.chunk.js","sourcesContent":["import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { FormattedMessage } from 'react-intl';\n\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { connect } from 'react-redux';\n\nimport { Button } from 'mastodon/components/button';\nimport { toServerSideType } from 'mastodon/utils/filters';\n\nconst mapStateToProps = (state, { filterId }) => ({\n  filter: state.getIn(['filters', filterId]),\n});\n\nclass AddedToFilter extends PureComponent {\n\n  static propTypes = {\n    onClose: PropTypes.func.isRequired,\n    contextType: PropTypes.string,\n    filter: ImmutablePropTypes.map.isRequired,\n    dispatch: PropTypes.func.isRequired,\n  };\n\n  handleCloseClick = () => {\n    const { onClose } = this.props;\n    onClose();\n  };\n\n  render () {\n    const { filter, contextType } = this.props;\n\n    let expiredMessage = null;\n    if (filter.get('expires_at') && filter.get('expires_at') < new Date()) {\n      expiredMessage = (\n        <>\n          <h4 className='report-dialog-modal__subtitle'><FormattedMessage id='filter_modal.added.expired_title' defaultMessage='Expired filter!' /></h4>\n          <p className='report-dialog-modal__lead'>\n            <FormattedMessage\n              id='filter_modal.added.expired_explanation'\n              defaultMessage='This filter category has expired, you will need to change the expiration date for it to apply.'\n            />\n          </p>\n        </>\n      );\n    }\n\n    let contextMismatchMessage = null;\n    if (contextType && !filter.get('context').includes(toServerSideType(contextType))) {\n      contextMismatchMessage = (\n        <>\n          <h4 className='report-dialog-modal__subtitle'><FormattedMessage id='filter_modal.added.context_mismatch_title' defaultMessage='Context mismatch!' /></h4>\n          <p className='report-dialog-modal__lead'>\n            <FormattedMessage\n              id='filter_modal.added.context_mismatch_explanation'\n              defaultMessage='This filter category does not apply to the context in which you have accessed this post. If you want the post to be filtered in this context too, you will have to edit the filter.'\n            />\n          </p>\n        </>\n      );\n    }\n\n    const settings_link = (\n      <a href={`/filters/${filter.get('id')}/edit`}>\n        <FormattedMessage\n          id='filter_modal.added.settings_link'\n          defaultMessage='settings page'\n        />\n      </a>\n    );\n\n    return (\n      <>\n        <h3 className='report-dialog-modal__title'><FormattedMessage id='filter_modal.added.title' defaultMessage='Filter added!' /></h3>\n        <p className='report-dialog-modal__lead'>\n          <FormattedMessage\n            id='filter_modal.added.short_explanation'\n            defaultMessage='This post has been added to the following filter category: {title}.'\n            values={{ title: filter.get('title') }}\n          />\n        </p>\n\n        {expiredMessage}\n        {contextMismatchMessage}\n\n        <h4 className='report-dialog-modal__subtitle'><FormattedMessage id='filter_modal.added.review_and_configure_title' defaultMessage='Filter settings' /></h4>\n        <p className='report-dialog-modal__lead'>\n          <FormattedMessage\n            id='filter_modal.added.review_and_configure'\n            defaultMessage='To review and further configure this filter category, go to the {settings_link}.'\n            values={{ settings_link }}\n          />\n        </p>\n\n        <div className='flex-spacer' />\n\n        <div className='report-dialog-modal__actions'>\n          <Button onClick={this.handleCloseClick}><FormattedMessage id='report.close' defaultMessage='Done' /></Button>\n        </div>\n      </>\n    );\n  }\n\n}\n\nexport default connect(mapStateToProps)(AddedToFilter);\n","import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { defineMessages, injectIntl, FormattedMessage } from 'react-intl';\n\nimport { connect } from 'react-redux';\n\nimport { ReactComponent as AddIcon } from '@material-symbols/svg-600/outlined/add.svg';\nimport fuzzysort from 'fuzzysort';\n\nimport { Icon }  from 'mastodon/components/icon';\nimport { toServerSideType } from 'mastodon/utils/filters';\nimport { loupeIcon, deleteIcon } from 'mastodon/utils/icons';\n\nconst messages = defineMessages({\n  search: { id: 'filter_modal.select_filter.search', defaultMessage: 'Search or create' },\n  clear: { id: 'emoji_button.clear', defaultMessage: 'Clear' },\n});\n\nconst mapStateToProps = (state, { contextType }) => ({\n  filters: Array.from(state.get('filters').values()).map((filter) => [\n    filter.get('id'),\n    filter.get('title'),\n    filter.get('keywords')?.map((keyword) => keyword.get('keyword')).join('\\n'),\n    filter.get('expires_at') && filter.get('expires_at') < new Date(),\n    contextType && !filter.get('context').includes(toServerSideType(contextType)),\n  ]),\n});\n\nclass SelectFilter extends PureComponent {\n\n  static propTypes = {\n    onSelectFilter: PropTypes.func.isRequired,\n    onNewFilter: PropTypes.func.isRequired,\n    filters: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.object)),\n    intl: PropTypes.object.isRequired,\n  };\n\n  state = {\n    searchValue: '',\n  };\n\n  search () {\n    const { filters } = this.props;\n    const { searchValue } = this.state;\n\n    if (searchValue === '') {\n      return filters;\n    }\n\n    return fuzzysort.go(searchValue, filters, {\n      keys: ['1', '2'],\n      limit: 5,\n      threshold: -10000,\n    }).map(result => result.obj);\n  }\n\n  renderItem = filter => {\n    let warning = null;\n    if (filter[3] || filter[4]) {\n      warning = (\n        <span className='language-dropdown__dropdown__results__item__common-name'>\n          (\n          {filter[3] && <FormattedMessage id='filter_modal.select_filter.expired' defaultMessage='expired' />}\n          {filter[3] && filter[4] && ', '}\n          {filter[4] && <FormattedMessage id='filter_modal.select_filter.context_mismatch' defaultMessage='does not apply to this context' />}\n          )\n        </span>\n      );\n    }\n\n    return (\n      <div key={filter[0]} role='button' tabIndex={0} data-index={filter[0]} className='language-dropdown__dropdown__results__item' onClick={this.handleItemClick} onKeyDown={this.handleKeyDown}>\n        <span className='language-dropdown__dropdown__results__item__native-name'>{filter[1]}</span> {warning}\n      </div>\n    );\n  };\n\n  renderCreateNew (name) {\n    return (\n      <div key='add-new-filter' role='button' tabIndex={0} className='language-dropdown__dropdown__results__item' onClick={this.handleNewFilterClick} onKeyDown={this.handleKeyDown}>\n        <Icon id='plus' icon={AddIcon} /> <FormattedMessage id='filter_modal.select_filter.prompt_new' defaultMessage='New category: {name}' values={{ name }} />\n      </div>\n    );\n  }\n\n  handleSearchChange = ({ target }) => {\n    this.setState({ searchValue: target.value });\n  };\n\n  setListRef = c => {\n    this.listNode = c;\n  };\n\n  handleKeyDown = e => {\n    const index = Array.from(this.listNode.childNodes).findIndex(node => node === e.currentTarget);\n\n    let element = null;\n\n    switch(e.key) {\n    case ' ':\n    case 'Enter':\n      e.currentTarget.click();\n      break;\n    case 'ArrowDown':\n      element = this.listNode.childNodes[index + 1] || this.listNode.firstChild;\n      break;\n    case 'ArrowUp':\n      element = this.listNode.childNodes[index - 1] || this.listNode.lastChild;\n      break;\n    case 'Tab':\n      if (e.shiftKey) {\n        element = this.listNode.childNodes[index - 1] || this.listNode.lastChild;\n      } else {\n        element = this.listNode.childNodes[index + 1] || this.listNode.firstChild;\n      }\n      break;\n    case 'Home':\n      element = this.listNode.firstChild;\n      break;\n    case 'End':\n      element = this.listNode.lastChild;\n      break;\n    }\n\n    if (element) {\n      element.focus();\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  handleSearchKeyDown = e => {\n    let element = null;\n\n    switch(e.key) {\n    case 'Tab':\n    case 'ArrowDown':\n      element = this.listNode.firstChild;\n\n      if (element) {\n        element.focus();\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      break;\n    }\n  };\n\n  handleClear = () => {\n    this.setState({ searchValue: '' });\n  };\n\n  handleItemClick = e => {\n    const value = e.currentTarget.getAttribute('data-index');\n\n    e.preventDefault();\n\n    this.props.onSelectFilter(value);\n  };\n\n  handleNewFilterClick = e => {\n    e.preventDefault();\n\n    this.props.onNewFilter(this.state.searchValue);\n  };\n\n  render () {\n    const { intl } = this.props;\n\n    const { searchValue } = this.state;\n    const isSearching = searchValue !== '';\n    const results = this.search();\n\n    return (\n      <>\n        <h3 className='report-dialog-modal__title'><FormattedMessage id='filter_modal.select_filter.title' defaultMessage='Filter this post' /></h3>\n        <p className='report-dialog-modal__lead'><FormattedMessage id='filter_modal.select_filter.subtitle' defaultMessage='Use an existing category or create a new one' /></p>\n\n        <div className='emoji-mart-search'>\n          <input type='search' value={searchValue} onChange={this.handleSearchChange} onKeyDown={this.handleSearchKeyDown} placeholder={intl.formatMessage(messages.search)} autoFocus />\n          <button type='button' className='emoji-mart-search-icon' disabled={!isSearching} aria-label={intl.formatMessage(messages.clear)} onClick={this.handleClear}>{!isSearching ? loupeIcon : deleteIcon}</button>\n        </div>\n\n        <div className='language-dropdown__dropdown__results emoji-mart-scroll' role='listbox' ref={this.setListRef}>\n          {results.map(this.renderItem)}\n          {isSearching && this.renderCreateNew(searchValue) }\n        </div>\n\n      </>\n    );\n  }\n\n}\n\nexport default connect(mapStateToProps)(injectIntl(SelectFilter));\n","import PropTypes from 'prop-types';\n\nimport { defineMessages, FormattedMessage, injectIntl } from 'react-intl';\n\nimport ImmutablePureComponent from 'react-immutable-pure-component';\nimport { connect } from 'react-redux';\n\nimport { ReactComponent as CloseIcon } from '@material-symbols/svg-600/outlined/close.svg';\n\nimport { fetchFilters, createFilter, createFilterStatus } from 'mastodon/actions/filters';\nimport { fetchStatus } from 'mastodon/actions/statuses';\nimport { IconButton } from 'mastodon/components/icon_button';\nimport AddedToFilter from 'mastodon/features/filters/added_to_filter';\nimport SelectFilter from 'mastodon/features/filters/select_filter';\n\nconst messages = defineMessages({\n  close: { id: 'lightbox.close', defaultMessage: 'Close' },\n});\n\nclass FilterModal extends ImmutablePureComponent {\n\n  static propTypes = {\n    statusId: PropTypes.string.isRequired,\n    contextType: PropTypes.string,\n    dispatch: PropTypes.func.isRequired,\n    intl: PropTypes.object.isRequired,\n  };\n\n  state = {\n    step: 'select',\n    filterId: null,\n    isSubmitting: false,\n    isSubmitted: false,\n  };\n\n  handleNewFilterSuccess = (result) => {\n    this.handleSelectFilter(result.id);\n  };\n\n  handleSuccess = () => {\n    const { dispatch, statusId } = this.props;\n    dispatch(fetchStatus(statusId, true));\n    this.setState({ isSubmitting: false, isSubmitted: true, step: 'submitted' });\n  };\n\n  handleFail = () => {\n    this.setState({ isSubmitting: false });\n  };\n\n  handleNextStep = step => {\n    this.setState({ step });\n  };\n\n  handleSelectFilter = (filterId) => {\n    const { dispatch, statusId } = this.props;\n\n    this.setState({ isSubmitting: true, filterId });\n\n    dispatch(createFilterStatus({\n      filter_id: filterId,\n      status_id: statusId,\n    }, this.handleSuccess, this.handleFail));\n  };\n\n  handleNewFilter = (title) => {\n    const { dispatch } = this.props;\n\n    this.setState({ isSubmitting: true });\n\n    dispatch(createFilter({\n      title,\n      context: ['home', 'notifications', 'public', 'thread', 'account'],\n      action: 'warn',\n    }, this.handleNewFilterSuccess, this.handleFail));\n  };\n\n  componentDidMount () {\n    const { dispatch } = this.props;\n\n    dispatch(fetchFilters());\n  }\n\n  render () {\n    const {\n      intl,\n      statusId,\n      contextType,\n      onClose,\n    } = this.props;\n\n    const {\n      step,\n      filterId,\n    } = this.state;\n\n    let stepComponent;\n\n    switch(step) {\n    case 'select':\n      stepComponent = (\n        <SelectFilter\n          contextType={contextType}\n          onSelectFilter={this.handleSelectFilter}\n          onNewFilter={this.handleNewFilter}\n        />\n      );\n      break;\n    case 'create':\n      stepComponent = null;\n      break;\n    case 'submitted':\n      stepComponent = (\n        <AddedToFilter\n          contextType={contextType}\n          filterId={filterId}\n          statusId={statusId}\n          onClose={onClose}\n        />\n      );\n    }\n\n    return (\n      <div className='modal-root__modal report-dialog-modal'>\n        <div className='report-modal__target'>\n          <IconButton className='report-modal__close' title={intl.formatMessage(messages.close)} icon='times' iconComponent={CloseIcon} onClick={onClose} size={20} />\n          <FormattedMessage id='filter_modal.title.status' defaultMessage='Filter a post' />\n        </div>\n\n        <div className='report-dialog-modal__container'>\n          {stepComponent}\n        </div>\n      </div>\n    );\n  }\n\n}\n\nexport default connect()(injectIntl(FilterModal));\n"],"sourceRoot":""}