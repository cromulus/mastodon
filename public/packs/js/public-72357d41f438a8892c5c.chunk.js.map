{"version":3,"sources":["webpack:///./node_modules/cocoon-js-vanilla/index.js","webpack:///./app/javascript/packs/public.jsx","webpack:///./app/javascript/mastodon/load_keyboard_extensions.js"],"names":["document","addEventListener","cocoonElementCounter","createNewID","Date","getTime","newcontentBraced","id","newcontentUnderscored","cocoonAddFields","e","target","preventDefault","stopPropagation","thisNode","assoc","getAttribute","assocs","content","insertionMethod","insertionNode","insertionTraversal","count","parseInt","regexpBraced","RegExp","regexpUnderscored","newId","newContent","replace","newContents","originalEvent","isNaN","Math","max","push","insertionNodeElem","console","warn","querySelector","parentNode","getInsertionNodeElem","length","forEach","node","i","contentNode","beforeInsert","CustomEvent","bubbles","cancelable","detail","dispatchEvent","defaultPrevented","htmlMapping","before","prepend","append","after","htmlMethod","addedContent","insertAdjacentHTML","previousElementSibling","firstElementChild","lastElementChild","nextElementSibling","afterInsert","cocoonRemoveFields","wrapperClass","nodeToDelete","closest","triggerNode","beforeRemove","timeout","setTimeout","classList","contains","parentElement","removeChild","elem","selector","sibling","matches","cocoonGetPreviousSibling","value","style","display","afterRemove","this","start","messages","defineMessages","usernameTaken","defaultMessage","passwordExceedsLength","passwordDoesNotMatch","loaded","localeData","getLocale","locale","documentElement","lang","dateTimeFormat","Intl","DateTimeFormat","year","month","day","hour","minute","dateFormat","timeFormat","timeStyle","hour12","formatMessage","_ref","values","IntlMessageFormat","format","call","querySelectorAll","innerHTML","emojify","datetime","formattedDate","title","textContent","todayFormat","formattedContent","date","today","getDate","getMonth","getFullYear","isToday","formattedTime","time","now","timeGiven","includes","timeAgoString","formatDate","options","reactComponents","then","_ref2","default","MediaContainer","component","children","child","createElement","createRoot","render","_jsx","components","body","appendChild","catch","error","Rails","delegate","_throttle","_ref3","axios","get","params","acct","setCustomValidity","leading","trailing","password","getElementById","confirmation","maxLength","statusEl","dataset","spoiler","spoilerLink","message","window","data","parent","type","ready","postMessage","height","getElementsByTagName","scrollHeight","_ref4","avatar","file","files","url","URL","createObjectURL","originalSrc","src","_ref5","focus","select","setSelectionRange","_ref6","input","oldReadOnly","readonly","execCommand","blur","add","remove","err","toggleSidebar","sidebar","toggleButton","overflow","setAttribute","toggle","key","_ref7","_ref8","field","loadPolyfills","loadLocale","test","navigator","userAgent","arrowKeyNav","register","Promise","resolve"],"mappings":"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","file":"js/public-72357d41f438a8892c5c.chunk.js","sourcesContent":["document.addEventListener('DOMContentLoaded', function () {\n  var cocoonElementCounter = 0;\n\n  var createNewID = function () {\n    return (new Date().getTime() + cocoonElementCounter++);\n  };\n\n  var newcontentBraced = function (id) {\n    return '[' + id + ']$1';\n  };\n\n  var newcontentUnderscored = function (id) {\n    return '_' + id + '_$1';\n  };\n\n  var getInsertionNodeElem = function (insertionNode, insertionTraversal, thisNode) {\n    if (!insertionNode) {\n      return thisNode.parentNode;\n    }\n\n    if (typeof insertionNode === 'function') {\n      if (insertionTraversal) {\n        console.warn('association-insertion-traversal is ignored, because association-insertion-node is given as a function.');\n      }\n      return insertionNode(thisNode);\n    }\n\n    if (typeof insertionNode === 'string') {\n      if (insertionTraversal) {\n        return thisNode[insertionTraversal](insertionNode);\n      } else {\n        return insertionNode === 'this' ? thisNode : document.querySelector(insertionNode);\n      }\n    }\n  };\n\n  var cocoonDetach = function (node) {\n    return node.parentElement.removeChild(node);\n  };\n\n  var cocoonGetPreviousSibling = function (elem, selector) {\n    var sibling = elem.previousElementSibling;\n\n    if (!selector) return sibling;\n\n    while (sibling) {\n      var match = sibling.matches(selector);\n      if (match) return sibling;\n      sibling = sibling.previousElementSibling;\n    }\n  };\n\n  var cocoonAddFields = function (e, target) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    var thisNode = target;\n    var assoc = thisNode.getAttribute('data-association');\n    var assocs = thisNode.getAttribute('data-associations');\n    var content = thisNode.getAttribute('data-association-insertion-template');\n    var insertionMethod = thisNode.getAttribute('data-association-insertion-method') || thisNode.getAttribute('data-association-insertion-position') || 'before';\n    var insertionNode = thisNode.getAttribute('data-association-insertion-node');\n    var insertionTraversal = thisNode.getAttribute('data-association-insertion-traversal');\n    var count = parseInt(thisNode.getAttribute('data-count'), 10);\n    var regexpBraced = new RegExp('\\\\[new_' + assoc + '\\\\](.*?\\\\s)', 'g');\n    var regexpUnderscored = new RegExp('_new_' + assoc + '_(\\\\w*)', 'g');\n    var newId = createNewID();\n    var newContent = content.replace(regexpBraced, newcontentBraced(newId));\n    var newContents = [];\n    var originalEvent = e;\n\n    if (newContent === content) {\n      regexpBraced = new RegExp('\\\\[new_' + assocs + '\\\\](.*?\\\\s)', 'g');\n      regexpUnderscored = new RegExp('_new_' + assocs + '_(\\\\w*)', 'g');\n      newContent = content.replace(regexpBraced, newcontentBraced(newId));\n    }\n\n    newContent = newContent.replace(regexpUnderscored, newcontentUnderscored(newId));\n    newContents = [newContent];\n\n    count = (isNaN(count) ? 1 : Math.max(count, 1));\n    count -= 1;\n\n    while (count) {\n      newId = createNewID();\n      newContent = content.replace(regexpBraced, newcontentBraced(newId));\n      newContent = newContent.replace(regexpUnderscored, newcontentUnderscored(newId));\n      newContents.push(newContent);\n\n      count -= 1;\n    }\n\n    var insertionNodeElem = getInsertionNodeElem(insertionNode, insertionTraversal, thisNode);\n\n    if (!insertionNodeElem || (insertionNodeElem.length === 0)) {\n      console.warn(\"Couldn't find the element to insert the template. Make sure your `data-association-insertion-*` on `link_to_add_association` is correct.\");\n    }\n\n    newContents.forEach(function (node, i) {\n      var contentNode = node;\n\n      var beforeInsert = new CustomEvent('cocoon:before-insert', { bubbles: true, cancelable: true, detail: [contentNode, originalEvent] });\n      insertionNodeElem.dispatchEvent(beforeInsert);\n\n      if (!beforeInsert.defaultPrevented) {\n        // allow any of the jquery dom manipulation methods (after, before, append, prepend, etc)\n        // to be called on the node.  allows the insertion node to be the parent of the inserted\n        // code and doesn't force it to be a sibling like after/before does. default: 'before'\n        var htmlMapping = {\n          before: 'beforebegin',\n          prepend: 'afterbegin',\n          append: 'beforeend',\n          after: 'afterend'\n        };\n\n        var htmlMethod = htmlMapping[insertionMethod];\n        var addedContent = insertionNodeElem.insertAdjacentHTML(htmlMethod, contentNode);\n\n        if (htmlMethod === htmlMapping.before) {\n          addedContent = insertionNodeElem.previousElementSibling;\n        } else if (htmlMethod === htmlMapping.prepend) {\n          addedContent = insertionNodeElem.firstElementChild;\n        } else if (htmlMethod === htmlMapping.append) {\n          addedContent = insertionNodeElem.lastElementChild;\n        } else if (htmlMethod === htmlMapping.after) {\n          addedContent = insertionNodeElem.nextElementSibling;\n        }\n\n        var afterInsert = new CustomEvent('cocoon:after-insert', { bubbles: true, detail: [contentNode, originalEvent, addedContent] });\n        insertionNodeElem.dispatchEvent(afterInsert);\n      }\n    });\n  };\n\n  var cocoonRemoveFields = function (e, target) {\n    var thisNode = target;\n    var wrapperClass = thisNode.getAttribute('data-wrapper-class') || 'nested-fields';\n    var nodeToDelete = thisNode.closest('.' + wrapperClass);\n    var triggerNode = nodeToDelete.parentNode;\n    var originalEvent = e;\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    var beforeRemove = new CustomEvent('cocoon:before-remove', { bubbles: true, cancelable: true, detail: [nodeToDelete, originalEvent] });\n    triggerNode.dispatchEvent(beforeRemove);\n\n    if (!beforeRemove.defaultPrevented) {\n      var timeout = triggerNode.getAttribute('data-remove-timeout') || 0;\n\n      setTimeout(function () {\n        if (thisNode.classList.contains('dynamic')) {\n          cocoonDetach(nodeToDelete);\n        } else {\n          var hiddenInput = cocoonGetPreviousSibling(thisNode, 'input[type=hidden]');\n          hiddenInput.value = '1';\n          nodeToDelete.style.display = 'none';\n        }\n        var afterRemove = new CustomEvent('cocoon:after-remove', { bubbles: true, detail: [nodeToDelete, originalEvent] });\n        triggerNode.dispatchEvent(afterRemove);\n      }, timeout);\n    }\n  };\n\n  document.addEventListener('click', function (e) {\n    for (var target = e.target; target && target !== this; target = target.parentNode) {\n      if (target.matches('.add_fields')) {\n        cocoonAddFields(e, target);\n        return;\n      }\n      if (target.matches('.remove_fields')) {\n        cocoonRemoveFields(e, target);\n        return;\n      }\n    }\n  }, false);\n});\n\n// TODO - Test this\n// document.addEventListener(\"DOMContentLoaded page:load turbolinks:load\", function () {\n//   var destroyedFields = document.querySelectorAll(\".remove_fields.existing.destroyed\");\n//   Array.prototype.forEach.call(destroyedFields, function (el) {\n//     var wrapperClass = el.getAttribute(\"data-wrapper-class\") || \"nested-fields\";\n//     el.closest(\".\" + wrapperClass).style.display = \"none\";\n//   });\n// });\n","import { createRoot }  from 'react-dom/client';\n\nimport './public-path';\n\nimport { IntlMessageFormat }  from 'intl-messageformat';\nimport { defineMessages } from 'react-intl';\n\nimport Rails from '@rails/ujs';\nimport axios from 'axios';\nimport { throttle } from 'lodash';\n\nimport { start } from '../mastodon/common';\nimport { timeAgoString }  from '../mastodon/components/relative_timestamp';\nimport emojify  from '../mastodon/features/emoji/emoji';\nimport loadKeyboardExtensions from '../mastodon/load_keyboard_extensions';\nimport { loadLocale, getLocale } from '../mastodon/locales';\nimport { loadPolyfills } from '../mastodon/polyfills';\nimport ready from '../mastodon/ready';\n\nimport 'cocoon-js-vanilla';\n\nstart();\n\nconst messages = defineMessages({\n  usernameTaken: { id: 'username.taken', defaultMessage: 'That username is taken. Try another' },\n  passwordExceedsLength: { id: 'password_confirmation.exceeds_maxlength', defaultMessage: 'Password confirmation exceeds the maximum password length' },\n  passwordDoesNotMatch: { id: 'password_confirmation.mismatching', defaultMessage: 'Password confirmation does not match' },\n});\n\nwindow.addEventListener('message', e => {\n  const data = e.data || {};\n\n  if (!window.parent || data.type !== 'setHeight') {\n    return;\n  }\n\n  ready(() => {\n    window.parent.postMessage({\n      type: 'setHeight',\n      id: data.id,\n      height: document.getElementsByTagName('html')[0].scrollHeight,\n    }, '*');\n  });\n});\n\nfunction loaded() {\n  const { messages: localeData } = getLocale();\n\n  const locale = document.documentElement.lang;\n\n  const dateTimeFormat = new Intl.DateTimeFormat(locale, {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: 'numeric',\n  });\n\n  const dateFormat = new Intl.DateTimeFormat(locale, {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n    timeFormat: false,\n  });\n\n  const timeFormat = new Intl.DateTimeFormat(locale, {\n    timeStyle: 'short',\n    hour12: false,\n  });\n\n  const formatMessage = ({ id, defaultMessage }, values) => {\n    const messageFormat = new IntlMessageFormat(localeData[id] || defaultMessage, locale);\n    return messageFormat.format(values);\n  };\n\n  [].forEach.call(document.querySelectorAll('.emojify'), (content) => {\n    content.innerHTML = emojify(content.innerHTML);\n  });\n\n  [].forEach.call(document.querySelectorAll('time.formatted'), (content) => {\n    const datetime = new Date(content.getAttribute('datetime'));\n    const formattedDate = dateTimeFormat.format(datetime);\n\n    content.title = formattedDate;\n    content.textContent = formattedDate;\n  });\n\n  const isToday = date => {\n    const today = new Date();\n\n    return date.getDate() === today.getDate() &&\n      date.getMonth() === today.getMonth() &&\n      date.getFullYear() === today.getFullYear();\n  };\n  const todayFormat = new IntlMessageFormat(localeData['relative_format.today'] || 'Today at {time}', locale);\n\n  [].forEach.call(document.querySelectorAll('time.relative-formatted'), (content) => {\n    const datetime = new Date(content.getAttribute('datetime'));\n\n    let formattedContent;\n\n    if (isToday(datetime)) {\n      const formattedTime = timeFormat.format(datetime);\n\n      formattedContent = todayFormat.format({ time: formattedTime });\n    } else {\n      formattedContent = dateFormat.format(datetime);\n    }\n\n    content.title = formattedContent;\n    content.textContent = formattedContent;\n  });\n\n  [].forEach.call(document.querySelectorAll('time.time-ago'), (content) => {\n    const datetime = new Date(content.getAttribute('datetime'));\n    const now      = new Date();\n\n    const timeGiven = content.getAttribute('datetime').includes('T');\n    content.title = timeGiven ? dateTimeFormat.format(datetime) : dateFormat.format(datetime);\n    content.textContent = timeAgoString({\n      formatMessage,\n      formatDate: (date, options) => (new Intl.DateTimeFormat(locale, options)).format(date),\n    }, datetime, now, now.getFullYear(), timeGiven);\n  });\n\n  const reactComponents = document.querySelectorAll('[data-component]');\n\n  if (reactComponents.length > 0) {\n    import(/* webpackChunkName: \"containers/media_container\" */ '../mastodon/containers/media_container')\n      .then(({ default: MediaContainer }) => {\n        [].forEach.call(reactComponents, (component) => {\n          [].forEach.call(component.children, (child) => {\n            component.removeChild(child);\n          });\n        });\n\n        const content = document.createElement('div');\n\n        const root = createRoot(content);\n        root.render(<MediaContainer locale={locale} components={reactComponents} />);\n        document.body.appendChild(content);\n      })\n      .catch(error => {\n        console.error(error);\n      });\n  }\n\n  Rails.delegate(document, '#user_account_attributes_username', 'input', throttle(({ target }) => {\n    if (target.value && target.value.length > 0) {\n      axios.get('/api/v1/accounts/lookup', { params: { acct: target.value } }).then(() => {\n        target.setCustomValidity(formatMessage(messages.usernameTaken));\n      }).catch(() => {\n        target.setCustomValidity('');\n      });\n    } else {\n      target.setCustomValidity('');\n    }\n  }, 500, { leading: false, trailing: true }));\n\n  Rails.delegate(document, '#user_password,#user_password_confirmation', 'input', () => {\n    const password = document.getElementById('user_password');\n    const confirmation = document.getElementById('user_password_confirmation');\n    if (!confirmation) return;\n\n    if (confirmation.value && confirmation.value.length > password.maxLength) {\n      confirmation.setCustomValidity(formatMessage(messages.passwordExceedsLength));\n    } else if (password.value && password.value !== confirmation.value) {\n      confirmation.setCustomValidity(formatMessage(messages.passwordDoesNotMatch));\n    } else {\n      confirmation.setCustomValidity('');\n    }\n  });\n\n  Rails.delegate(document, '.status__content__spoiler-link', 'click', function() {\n    const statusEl = this.parentNode.parentNode;\n\n    if (statusEl.dataset.spoiler === 'expanded') {\n      statusEl.dataset.spoiler = 'folded';\n      this.textContent = (new IntlMessageFormat(localeData['status.show_more'] || 'Show more', locale)).format();\n    } else {\n      statusEl.dataset.spoiler = 'expanded';\n      this.textContent = (new IntlMessageFormat(localeData['status.show_less'] || 'Show less', locale)).format();\n    }\n\n    return false;\n  });\n\n  [].forEach.call(document.querySelectorAll('.status__content__spoiler-link'), (spoilerLink) => {\n    const statusEl = spoilerLink.parentNode.parentNode;\n    const message = (statusEl.dataset.spoiler === 'expanded') ? (localeData['status.show_less'] || 'Show less') : (localeData['status.show_more'] || 'Show more');\n    spoilerLink.textContent = (new IntlMessageFormat(message, locale)).format();\n  });\n}\n\nRails.delegate(document, '#edit_profile input[type=file]', 'change', ({ target }) => {\n  const avatar = document.getElementById(target.id + '-preview');\n  const [file] = target.files || [];\n  const url = file ? URL.createObjectURL(file) : avatar.dataset.originalSrc;\n\n  avatar.src = url;\n});\n\nRails.delegate(document, '.input-copy input', 'click', ({ target }) => {\n  target.focus();\n  target.select();\n  target.setSelectionRange(0, target.value.length);\n});\n\nRails.delegate(document, '.input-copy button', 'click', ({ target }) => {\n  const input = target.parentNode.querySelector('.input-copy__wrapper input');\n\n  const oldReadOnly = input.readonly;\n\n  input.readonly = false;\n  input.focus();\n  input.select();\n  input.setSelectionRange(0, input.value.length);\n\n  try {\n    if (document.execCommand('copy')) {\n      input.blur();\n      target.parentNode.classList.add('copied');\n\n      setTimeout(() => {\n        target.parentNode.classList.remove('copied');\n      }, 700);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n\n  input.readonly = oldReadOnly;\n});\n\nconst toggleSidebar = () => {\n  const sidebar = document.querySelector('.sidebar ul');\n  const toggleButton = document.querySelector('.sidebar__toggle__icon');\n\n  if (sidebar.classList.contains('visible')) {\n    document.body.style.overflow = null;\n    toggleButton.setAttribute('aria-expanded', 'false');\n  } else {\n    document.body.style.overflow = 'hidden';\n    toggleButton.setAttribute('aria-expanded', 'true');\n  }\n\n  toggleButton.classList.toggle('active');\n  sidebar.classList.toggle('visible');\n};\n\nRails.delegate(document, '.sidebar__toggle__icon', 'click', () => {\n  toggleSidebar();\n});\n\nRails.delegate(document, '.sidebar__toggle__icon', 'keydown', e => {\n  if (e.key === ' ' || e.key === 'Enter') {\n    e.preventDefault();\n    toggleSidebar();\n  }\n});\n\nRails.delegate(document, '.custom-emoji', 'mouseover', ({ target }) => target.src = target.getAttribute('data-original'));\nRails.delegate(document, '.custom-emoji', 'mouseout', ({ target }) => target.src = target.getAttribute('data-static'));\n\n// Empty the honeypot fields in JS in case something like an extension\n// automatically filled them.\nRails.delegate(document, '#registration_new_user,#new_user', 'submit', () => {\n  ['user_website', 'user_confirm_password', 'registration_user_website', 'registration_user_confirm_password'].forEach(id => {\n    const field = document.getElementById(id);\n    if (field) {\n      field.value = '';\n    }\n  });\n});\n\nfunction main() {\n  ready(loaded);\n}\n\nloadPolyfills()\n  .then(loadLocale)\n  .then(main)\n  .then(loadKeyboardExtensions)\n  .catch(error => {\n    console.error(error);\n  });\n","// On KaiOS, we may not be able to use a mouse cursor or navigate using Tab-based focus, so we install\n// special left/right focus navigation keyboard listeners, at least on public pages (i.e. so folks\n// can at least log in using KaiOS devices).\n\nfunction importArrowKeyNavigation() {\n  return import(/* webpackChunkName: \"arrow-key-navigation\" */ 'arrow-key-navigation');\n}\n\nexport default function loadKeyboardExtensions() {\n  if (/KAIOS/.test(navigator.userAgent)) {\n    return importArrowKeyNavigation().then(arrowKeyNav => {\n      arrowKeyNav.register();\n    });\n  }\n  return Promise.resolve();\n}\n"],"sourceRoot":""}