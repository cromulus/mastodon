(window.webpackJsonp=window.webpackJsonp||[]).push([[453],{1382:function(e,t,s){"use strict";s.r(t);var a=s(0),o=s(1),n=s(2),i=s(8),c=s(22),r=s(50),d=s(97),l=s(10),h=s(116),p=s(169),u=s(95),m=s(316),b=s(185),g=s(183),v=s(52),j=s.n(v),O=s(3),M=s.n(O),f=s(17),_=s.n(f),y=s(19),x=s(312),w=s(13),C=s(20),k=s(32),I=s(43),R=(s(31),s(11)),L=s.n(R),T=s(21),D=s(33),N=s(118),S=s(131),q=s(153),H=s(222),U=s(6),P=s(44);class A extends n.PureComponent{renderItem(e,t,s){const{animate:o}=this.props;let n=50,i=100,c="auto",r="auto",d="auto",l="auto";1===t&&(n=100),(4===t||3===t&&s>0)&&(i=50),2===t?0===s?l="1px":r="1px":3===t?(0===s?l="1px":s>0&&(r="1px"),1===s?d="1px":s>1&&(c="1px")):4===t&&(0!==s&&2!==s||(l="1px"),1!==s&&3!==s||(r="1px"),s<2?d="1px":c="1px");const h={left:r,top:c,right:l,bottom:d,width:`${n}%`,height:`${i}%`};return Object(a.a)("div",{style:h},e.get("id"),Object(a.a)(P.a,{account:e,animate:o}))}render(){const{accounts:e,size:t}=this.props;return Object(a.a)("div",{className:"account__avatar-composite",style:{width:`${t}px`,height:`${t}px`}},void 0,e.take(4).map(((t,s)=>this.renderItem(t,Math.min(e.size,4),s))),e.size>4&&Object(a.a)("span",{className:"account__avatar-composite__label"},void 0,"+",e.size-4))}}Object(o.a)(A,"defaultProps",{animate:U.a});var $=s(25),K=s(88),z=s(149),E=s(154),V=s(37);const W=Object(i.d)({more:{id:"status.more",defaultMessage:"More"},open:{id:"conversation.open",defaultMessage:"View conversation"},reply:{id:"status.reply",defaultMessage:"Reply"},markAsRead:{id:"conversation.mark_as_read",defaultMessage:"Mark as read"},delete:{id:"conversation.delete",defaultMessage:"Delete conversation"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"}});class J extends y.a{constructor(){super(...arguments),Object(o.a)(this,"handleMouseEnter",(e=>{let{currentTarget:t}=e;if(U.a)return;const s=t.querySelectorAll(".custom-emoji");for(var a=0;a<s.length;a++){let e=s[a];e.src=e.getAttribute("data-original")}})),Object(o.a)(this,"handleMouseLeave",(e=>{let{currentTarget:t}=e;if(U.a)return;const s=t.querySelectorAll(".custom-emoji");for(var a=0;a<s.length;a++){let e=s[a];e.src=e.getAttribute("data-static")}})),Object(o.a)(this,"handleClick",(()=>{if(!this.props.history)return;const{lastStatus:e,unread:t,markRead:s}=this.props;t&&s(),this.props.history.push(`/@${e.getIn(["account","acct"])}/${e.get("id")}`)})),Object(o.a)(this,"handleMarkAsRead",(()=>{this.props.markRead()})),Object(o.a)(this,"handleReply",(()=>{this.props.reply(this.props.lastStatus,this.props.history)})),Object(o.a)(this,"handleDelete",(()=>{this.props.delete()})),Object(o.a)(this,"handleHotkeyMoveUp",(()=>{this.props.onMoveUp(this.props.conversationId)})),Object(o.a)(this,"handleHotkeyMoveDown",(()=>{this.props.onMoveDown(this.props.conversationId)})),Object(o.a)(this,"handleConversationMute",(()=>{this.props.onMute(this.props.lastStatus)})),Object(o.a)(this,"handleShowMore",(()=>{this.props.onToggleHidden(this.props.lastStatus)}))}render(){const{accounts:e,lastStatus:t,unread:s,scrollKey:o,intl:n}=this.props;if(null===t)return null;const i=[{text:n.formatMessage(W.open),action:this.handleClick},null];i.push({text:n.formatMessage(t.get("muted")?W.unmuteConversation:W.muteConversation),action:this.handleConversationMute}),s&&(i.push({text:n.formatMessage(W.markAsRead),action:this.handleMarkAsRead}),i.push(null)),i.push({text:n.formatMessage(W.delete),action:this.handleDelete});const r=e.map((e=>Object(a.a)(T.a,{to:`/@${e.get("acct")}`,title:e.get("acct")},e.get("id"),Object(a.a)("bdi",{},void 0,Object(a.a)("strong",{className:"display-name__html",dangerouslySetInnerHTML:{__html:e.get("display_name_html")}}))))).reduce(((e,t)=>[e,", ",t])),d={reply:this.handleReply,open:this.handleClick,moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,toggleHidden:this.handleShowMore};return Object(a.a)(q.HotKeys,{handlers:d},void 0,Object(a.a)("div",{className:L()("conversation focusable muted",{"conversation--unread":s}),tabIndex:0},void 0,Object(a.a)("div",{className:"conversation__avatar",onClick:this.handleClick,role:"presentation"},void 0,Object(a.a)(A,{accounts:e,size:48})),Object(a.a)("div",{className:"conversation__content"},void 0,Object(a.a)("div",{className:"conversation__content__info"},void 0,Object(a.a)("div",{className:"conversation__content__relative-time"},void 0,s&&Object(a.a)("span",{className:"conversation__unread"})," ",Object(a.a)(K.a,{timestamp:t.get("created_at")})),Object(a.a)("div",{className:"conversation__content__names",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},void 0,Object(a.a)(c.a,{id:"conversation.with",defaultMessage:"With {names}",values:{names:Object(a.a)("span",{},void 0,r)}}))),Object(a.a)(z.a,{status:t,onClick:this.handleClick,expanded:!t.get("hidden"),onExpandedToggle:this.handleShowMore,collapsible:!0}),t.get("media_attachments").size>0&&Object(a.a)(H.a,{compact:!0,media:t.get("media_attachments")}),Object(a.a)("div",{className:"status__action-bar"},void 0,Object(a.a)($.a,{className:"status__action-bar-button",title:n.formatMessage(W.reply),icon:"reply",iconComponent:S.a,onClick:this.handleReply}),Object(a.a)("div",{className:"status__action-bar-dropdown"},void 0,Object(a.a)(E.a,{scrollKey:o,status:t,items:i,icon:"ellipsis-h",iconComponent:N.a,size:18,direction:"right",title:n.formatMessage(W.more)}))))))}}Object(o.a)(J,"propTypes",{conversationId:M.a.string.isRequired,accounts:_.a.list.isRequired,lastStatus:_.a.map,unread:M.a.bool.isRequired,scrollKey:M.a.string,onMoveUp:M.a.func,onMoveDown:M.a.func,markRead:M.a.func.isRequired,delete:M.a.func.isRequired,intl:M.a.object.isRequired,...V.b});var F=Object(D.i)(Object(r.c)(J));const Y=Object(i.d)({replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"}});var B=Object(r.c)(Object(l.connect)((()=>{const e=Object(I.i)();return(t,s)=>{let{conversationId:a}=s;const o=t.getIn(["conversations","items"]).find((e=>e.get("id")===a)),n=o.get("last_status",null);return{accounts:o.get("accounts").map((e=>t.getIn(["accounts",e],null))),unread:o.get("unread"),lastStatus:n&&e(t,{id:n})}}}),((e,t)=>{let{intl:s,conversationId:a}=t;return{markRead(){e(Object(u.k)(a))},reply(t,a){e(((o,n)=>{0!==n().getIn(["compose","text"]).trim().length?e(Object(C.b)({modalType:"CONFIRM",modalProps:{message:s.formatMessage(Y.replyMessage),confirm:s.formatMessage(Y.replyConfirm),onConfirm:()=>e(Object(w.xb)(t,a))}})):e(Object(w.xb)(t,a))}))},delete(){e(Object(u.i)(a))},onMute(t){t.get("muted")?e(Object(k.u)(t.get("id"))):e(Object(k.p)(t.get("id")))},onToggleHidden(t){t.get("hidden")?e(Object(k.q)(t.get("id"))):e(Object(k.o)(t.get("id")))}}}))(F)),G=s(5);class Q extends y.a{constructor(){super(...arguments),Object(o.a)(this,"getCurrentIndex",(e=>this.props.conversations.findIndex((t=>t.get("id")===e)))),Object(o.a)(this,"handleMoveUp",(e=>{const t=this.getCurrentIndex(e)-1;this._selectChild(t,!0)})),Object(o.a)(this,"handleMoveDown",(e=>{const t=this.getCurrentIndex(e)+1;this._selectChild(t,!1)})),Object(o.a)(this,"setRef",(e=>{this.node=e})),Object(o.a)(this,"handleLoadOlder",j()((()=>{const e=this.props.conversations.last();e&&e.get("last_status")&&this.props.onLoadMore(e.get("last_status"))}),300,{leading:!0}))}_selectChild(e,t){const s=this.node.node,a=s.querySelector(`article:nth-of-type(${e+1}) .focusable`);a&&(t&&s.scrollTop>a.offsetTop?a.scrollIntoView(!0):!t&&s.scrollTop+s.clientHeight<a.offsetTop+a.offsetHeight&&a.scrollIntoView(!1),a.focus())}render(){const{conversations:e,isLoading:t,onLoadMore:s,...o}=this.props;return Object(G.jsx)(x.a,{...o,isLoading:t,showLoading:t&&e.isEmpty(),onLoadMore:s&&this.handleLoadOlder,ref:this.setRef,children:e.map((e=>Object(a.a)(B,{conversationId:e.get("id"),onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,scrollKey:this.props.scrollKey},e.get("id"))))})}}Object(o.a)(Q,"propTypes",{conversations:_.a.list.isRequired,scrollKey:M.a.string.isRequired,hasMore:M.a.bool,isLoading:M.a.bool,onLoadMore:M.a.func});var X=Object(l.connect)((e=>({conversations:e.getIn(["conversations","items"]),isLoading:e.getIn(["conversations","isLoading"],!0),hasMore:e.getIn(["conversations","hasMore"],!1)})),(e=>({onLoadMore:t=>e(Object(u.j)({maxId:t}))})))(Q);const Z=Object(i.d)({title:{id:"column.direct",defaultMessage:"Private mentions"}});class ee extends n.PureComponent{constructor(){super(...arguments),Object(o.a)(this,"handlePin",(()=>{const{columnId:e,dispatch:t}=this.props;t(e?Object(p.h)(e):Object(p.e)("DIRECT",{}))})),Object(o.a)(this,"handleMove",(e=>{const{columnId:t,dispatch:s}=this.props;s(Object(p.g)(t,e))})),Object(o.a)(this,"handleHeaderClick",(()=>{this.column.scrollTop()})),Object(o.a)(this,"setRef",(e=>{this.column=e})),Object(o.a)(this,"handleLoadMore",(e=>{this.props.dispatch(Object(u.j)({maxId:e}))}))}componentDidMount(){const{dispatch:e}=this.props;e(Object(u.l)()),e(Object(u.j)()),this.disconnect=e(Object(m.b)())}componentWillUnmount(){this.props.dispatch(Object(u.m)()),this.disconnect&&(this.disconnect(),this.disconnect=null)}render(){const{intl:e,hasUnread:t,columnId:s,multiColumn:o}=this.props,n=!!s;return Object(G.jsxs)(b.a,{bindToDocument:!o,ref:this.setRef,label:e.formatMessage(Z.title),children:[Object(a.a)(g.a,{icon:"at",iconComponent:h.a,active:t,title:e.formatMessage(Z.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:n,multiColumn:o}),Object(a.a)(X,{trackScroll:!n,scrollKey:`direct_timeline-${s}`,timelineId:"direct",bindToDocument:!o,onLoadMore:this.handleLoadMore,prepend:Object(a.a)("div",{className:"follow_requests-unlocked_explanation"},void 0,Object(a.a)("span",{},void 0,Object(a.a)(c.a,{id:"compose_form.encryption_warning",defaultMessage:"Posts on Mastodon are not end-to-end encrypted. Do not share any dangerous information over Mastodon."})," ",Object(a.a)("a",{href:"/terms",target:"_blank"},void 0,Object(a.a)(c.a,{id:"compose_form.direct_message_warning_learn_more",defaultMessage:"Learn more"})))),alwaysPrepend:!0,emptyMessage:Object(a.a)(c.a,{id:"empty_column.direct",defaultMessage:"You don't have any private mentions yet. When you send or receive one, it will show up here."})}),Object(a.a)(d.a,{},void 0,Object(a.a)("title",{},void 0,e.formatMessage(Z.title)),Object(a.a)("meta",{name:"robots",content:"noindex"}))]})}}t.default=Object(l.connect)()(Object(r.c)(ee))}}]);
//# sourceMappingURL=direct_timeline-75ad13a1a7f2da62be0b.chunk.js.map